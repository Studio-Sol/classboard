<div class="row p-4 mt-4 shadow box">
    <div style="display: flex; justify-content: space-between">
        <a href="/notice">
            <h3><strong>공지사항</strong></h3>
        </a>
        <div>
            <% if (user_type == "teacher") { %>
                <a href="/new-notice" style="color: var(--link);">
                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"/></svg>
                    공지 작성
                </a>
            <% } %>
        </div>
    </div>

    <ul id="notice" class="list-group"></ul>
    <script>
        async function fetchNotice() {
            $("#notice").innerHTML = "로드중...";

            fetch(`/api/notice?skip=0`, {
                method: "GET",
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.success) {
                        $("#notice").innerHTML = "";
                        for (const d of data.notice) {
                            $("#notice").insertAdjacentHTML(
                                "beforeend",
                                `<li class="list-group-item" onclick="openNotice('${d.id}')">${d.title}</li>`
                            );
                        }
                        if (data.notice.length == 0) {
                            $("#notice").insertAdjacentHTML(
                                "beforeend",
                                `<strong class="list-group-item">공지 없음</strong>`
                            );
                        }
                    } else {
                        $("#notice").innerHTML = "오류가 발생했습니다.";
                        throw Error(
                            data.message ??
                                "fetchNotice:success->false, no message"
                        );
                    }
                });
        }
        window.addEventListener("load", fetchNotice)
    </script>
</div>
