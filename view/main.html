<!DOCTYPE html>
<html>

<head>

    <style>
        td.class:hover,
        th.dayofweek:hover {
            background-color: var(--hover);
            cursor: pointer;
        }
        .dayofweek {
            text-align: center;
        }
        @media screen and (max-width: 800px) {
            td {
                font-size: small;
            }
        }
    </style>
    
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"> 
        <link href="/static/style.css" , rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이번주 우리반은</title>
    
    <script src="https://kit.fontawesome.com/76a19131cd.js" crossorigin="anonymous" async></script>
    <style>
        @keyframes spinner {
            from {transform: rotate(0deg); }
            to {transform: rotate(360deg);}
        }
        @keyframes fadeout {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
                display: none;
            }
        }
        .spinner {
            box-sizing: border-box;
            width: 20vh;
            height: 20vh;
            margin-top: -32px;
            margin-left: -32px;
            border-radius: 50%;
            border: 1rem solid transparent;
            border-top-color: #22c8f1;
            border-bottom-color: #22c8f1;
            animation: spinner .8s ease infinite;
            
        }
        .fadeout {
            animation: fadeout 0.5s;
        }
    </style>
</head>

<body>
    <div class="container-xl w-auto" style="height: 100%;" id="main">
        <div class="row mb-2" style="height: 7em;">
            <div class="col p-lg-4 p-3 mt-3 m-lg-3 shadow box">
                <div class="row d-flex align-items-center h-100">
                    <div class="col">
                        <div>
                            <h2 style="margin: 0px;"><strong id="school-grade-class">로딩...</strong></h2>
                        </div>
                    </div>

                    <div class="col"  style="display: flex; justify-content: space-between; align-items: center;">
                        <div></div>
                        <div class="theme-switch-wrapper">
                            <% if (user.type == "teacher") { %>
                                <a href="/teacher" target="__blank">
                                    <button class="btn btn-primary">선생님 메뉴</button>
                                </a>
                            <% } %>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="row mt-lg-4 mt-3">
            <div class="col-lg-7 p-lg-4 pt-3 m-lg-3 shadow box" style="height: fit-content;" id="timetable">
                <h2 style="display: inline-block; width:fit-content;"><strong>시간표</strong></h2>
                <a href="#" onclick="fetchTimeTable(monday, 'true')" title="시간표 업데이트">
                    <button class="btn p-0" style="width: 2em;">
                        <i class="fa fa-refresh"></i>
                    </button>
                </a>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th style="width: 5%"></th>
                            <th style="width: 19%" class="dayofweek">월</th>
                            <th style="width: 19%" class="dayofweek">화</th>
                            <th style="width: 19%" class="dayofweek">수</th>
                            <th style="width: 19%" class="dayofweek">목</th>
                            <th style="width: 19%" class="dayofweek">금</th>
                        </tr>

                    </thead>
                    <tbody>
                        <tr>
                            <th>1 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                        <tr>
                            <th>2 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                        <tr>
                            <th>3 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                        <tr>
                            <th>4 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                        <tr>
                            <th>5 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                        <tr>
                            <th>6 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                        <tr>
                            <th>7 </th>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                            <td class="class"> </td>
                        </tr>
                    </tbody>
                </table>
                <div class="p-3 mt-4 mb-lg-0 mb-3" style="border-color: var(--text);border-style: solid; border-width: 1px;">
                    <h3><strong>급식</strong></h3>
                    <h5 id="meal-date"></h5>
                    <p id="meal">로드중..</p>
                </div>
            </div>
            <div class="col m-lg-3 mt-3">
                <div class="row p-4 shadow box">
                    <div style="display: flex;justify-content: space-between;">
                        <a href="/notice" target="__blank">
                            <h3><strong>공지사항</strong></h3>
                        </a>
                        <div>
                            <% if (user.type == "teacher") { %>
                                <a href="/new-notice" target="__blank">
                                    <button class="btn p-0" style="width: 2em;">
                                        <i class="fa fa-pencil"></i>
                                    </button>
                                </a>
                            <% } %>
                        </div>

                    </div>

                    <ul id="notice" class="list-group">

                    </ul>
                </div>
                <div class="row p-4 mt-4 shadow box">
                    <div style="display: flex;justify-content: space-between;">
                        <a href="/post" target="__blank" style="width:fit-content;">
                            <h3 style="display: inline-block; width:fit-content;"><strong>게시물</strong></h3>
                        </a>
                        <button class="btn p-0" style="width: 2em;" onclick="newPost();">
                            <i class="fa fa-pencil"></i>
                        </button>
                    </div>
                    <ul id="metadata" class="list-group">

                    </ul>
                </div>
            </div>
        </div>
        <div class="row mt-lg-0 mt-4 mb-4" style="display: flex;align-items: center;">
            <div class="col p-4 m-lg-3 mt-0 shadow box" style="display: flex; justify-content: space-between;align-items: center;">
                <p style="margin: 0px; height: fit-content;">&copy; 2022. Sol-Studio. All Rights Reserved.</p>
                <button class="btn btn-primary" onclick="location = 'https:\/\/toss.me/SolStudio'">후원</button>
            </div>
        </div>
    </div>

    <div id="overlay" style="position:fixed; height: 100%; width: 100%; background-color: rgba(0,0,0,0.6);top: 0px; left:0px; display: none; justify-content: center; align-items: center">
        <div></div>
    </div>
    <div id="loading" style="position:fixed; height: 100%; width: 100%; background-color: rgba(0,0,0,0.6);top: 0px; left:0px; display: flex; justify-content: center; align-items: center">
        <div><div class="spinner"></div></div>
    </div>
    <div class="modal fade" tabindex="-1" role="dialog" id="error">
        <div class="modal-dialog" role="document">
            <div class="modal-content shadow box" style="background-color: var(--box-bg);">
                <div class="modal-header">
                    <h5 class="modal-title text-danger">오류!</h5>
                </div>
                <div class="modal-body" style="color: var(--text)">
                    <p id="error-message"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="$('#overlay').hide();$('#error').removeClass('show').hide();">닫기</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        var monday = "<%= monday.replaceAll("-", "") %>";
        var grade = "<%= grade %>"
        var class_ = "<%= classroom %>"
        var school_name = "<%= school_name %>"
    </script>
    
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/static/main.js"></script>
</body>

</html>